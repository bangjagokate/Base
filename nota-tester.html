<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nota Tester - Hanifa Laundry</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }
        .receipt {
            background-color: white;
            border: 1px solid #ddd;
            padding: 25px;
            max-width: 500px;
            margin: 30px auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 5px;
        }
        .receipt-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed #333;
            padding-bottom: 15px;
        }
        .receipt-header h4 {
            font-weight: 700;
            margin-bottom: 5px;
            color: #0d6efd;
        }
        .service-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dotted #ddd;
        }
        .total-section {
            border-top: 2px solid #333;
            padding-top: 10px;
            margin-top: 15px;
            font-weight: bold;
        }
        .qr-container {
            text-align: center;
            margin: 15px 0;
        }
        .qr-container canvas {
            border: 1px solid #ddd;
            padding: 5px;
            background: white;
        }
        .tester-controls {
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">Nota Tester QR Code</h1>
        
        <div class="tester-controls">
            <div class="mb-3">
                <label for="nota-id" class="form-label">ID Nota</label>
                <input type="text" class="form-control" id="nota-id" value="NOTA123">
            </div>
            <div class="mb-3">
                <label for="base-url" class="form-label">Base URL Status Nota</label>
                <input type="text" class="form-control" id="base-url" value="https://laundryapp-87cb5.web.app/status-nota.html">
            </div>
            <button class="btn btn-primary" id="generate-btn">Generate Nota</button>
            <button class="btn btn-success" id="test-btn">Test QR Code</button>
        </div>
        
        <div class="receipt" id="receipt">
            <div class="receipt-header">
                <h4>HANIFA LAUNDRY</h4>
                <p>Kalibagor, Banyumas</p>
                <p>Telp: 085641344448</p>
            </div>
            <hr>
            <div class="receipt-body">
                <p><strong>No. Nota:</strong> <span id="receipt-number">NOTA123</span></p>
                <p><strong>Tanggal:</strong> <span id="receipt-date">-</span></p>
                <p><strong>Pelanggan:</strong> <span id="receipt-customer">Pelanggan Tester</span></p>
                <p><strong>Telp:</strong> <span id="receipt-phone">08123456789</span></p>
                <hr>
                
                <!-- QR Code akan muncul di sini -->
                <div class="qr-container" id="qr-container">
                    <p>QR Code akan muncul di sini</p>
                </div>
                <p class="text-center"><small>Scan untuk cek status online</small></p>
                <hr>
                
                <h6>Detail Layanan:</h6>
                <div id="receipt-services">
                    <div class="service-item">
                        <span>Cuci Kiloan x1</span>
                        <span>Rp 15.000</span>
                    </div>
                    <div class="service-item">
                        <span>Setrika Satuan x3</span>
                        <span>Rp 12.000</span>
                    </div>
                </div>
                <div class="total-section">
                    <div class="d-flex justify-content-between">
                        <span>Ongkos Kirim:</span>
                        <span id="receipt-delivery">Rp 5.000</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Total:</span>
                        <span id="receipt-total">Rp 32.000</span>
                    </div>
                </div>
            </div>
            <div class="receipt-footer">
                <p class="text-center"><small>Ini adalah nota tester untuk validasi QR code</small></p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set tanggal sekarang
            const now = new Date();
            document.getElementById('receipt-date').textContent = now.toLocaleString('id-ID');
            
            // Generate QR code saat halaman dimuat
            generateQRCode();
            
            // Event listener untuk tombol generate
            document.getElementById('generate-btn').addEventListener('click', function() {
                const notaId = document.getElementById('nota-id').value;
                document.getElementById('receipt-number').textContent = notaId;
                generateQRCode();
            });
            
            // Event listener untuk tombol test
            document.getElementById('test-btn').addEventListener('click', function() {
                const statusUrl = getStatusUrl();
                window.open(statusUrl, '_blank');
            });
        });
        
        function getStatusUrl() {
            const baseUrl = document.getElementById('base-url').value;
            const notaId = document.getElementById('nota-id').value;
            return `${baseUrl}?id=${notaId}`;
        }
        
        function generateQRCode() {
            const qrContainer = document.getElementById('qr-container');
            qrContainer.innerHTML = ''; // Clear previous QR code
            
            const statusUrl = getStatusUrl();
            
            QRCode.toCanvas(qrContainer, statusUrl, { 
                width: 150,
                margin: 1,
                color: {
                    dark: '#000000',
                    light: '#ffffff'
                }
            }, function (error) {
                if (error) {
                    console.error('Error generating QR code:', error);
                    qrContainer.innerHTML = '<p class="text-danger">Gagal generate QR code</p>';
                }
            });
        }
    </script>
</body>
</html>
